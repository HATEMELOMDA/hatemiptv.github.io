
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>IPTV - القنوات العربية الاحترافية</title>
  <style>
    * { box-sizing: border-box; }
    body { margin: 0; display: flex; height: 100vh; background: #121212; font-family: 'Segoe UI', sans-serif; color: white; }
    aside { width: 320px; background: #1e1e1e; overflow-y: auto; border-left: 3px solid #0f0; padding: 10px; }
    aside h2 { margin: 0; padding: 10px; background: #0f0; color: #000; text-align: center; }
    .channel { padding: 12px; border-bottom: 1px solid #333; cursor: pointer; }
    .channel:hover { background: #2c2c2c; }
    .active { background: #0f0; color: black; }
    main { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 20px; }
    video { width: 90%; height: auto; border: 3px solid #0f0; background: black; }
    #search { width: 100%; padding: 10px; font-size: 16px; margin-bottom: 10px; }
  </style>
</head>
<body>
  <aside>
    <h2>📺 القنوات العربية</h2>
    <input type="text" id="search" placeholder="ابحث عن قناة..." oninput="filterChannels()" />
    <div id="channelList"></div>
  </aside>
  <main>
    <h1>IPTV - بث مباشر لـ 429 قناة</h1>
    <video id="videoPlayer" controls autoplay></video>
  </main>
  <script>
    let channels = [];
    async function loadChannels() {
      const res = await fetch("channels.m3u");
      const text = await res.text();
      const lines = text.split("\n");
      const list = document.getElementById("channelList");
      for (let i = 0; i < lines.length; i++) {
        if (lines[i].startsWith("#EXTINF")) {
          const name = lines[i].split(",")[1] || "قناة غير معروفة";
          const url = lines[i + 1];
          const item = { name, url };
          channels.push(item);
        }
      }
      renderChannels(channels);
    }

    function renderChannels(filtered) {
      const list = document.getElementById("channelList");
      list.innerHTML = "";
      filtered.forEach(ch => {
        const div = document.createElement("div");
        div.className = "channel";
        div.textContent = ch.name;
        div.onclick = () => playChannel(ch.url, div);
        list.appendChild(div);
      });
    }

    function playChannel(url, element) {
      document.querySelectorAll(".channel").forEach(el => el.classList.remove("active"));
      element.classList.add("active");
      const player = document.getElementById("videoPlayer");
      player.src = url;
      player.play();
    }

    function filterChannels() {
      const query = document.getElementById("search").value.toLowerCase();
      const filtered = channels.filter(c => c.name.toLowerCase().includes(query));
      renderChannels(filtered);
    }

    loadChannels();
  </script>
</body>
</html>
